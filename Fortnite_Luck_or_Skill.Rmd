---
title: "Fortnite - Luck or Skill?"
author: "Dave Smith"
date: "2018-06-02"
output: html_document
---

```{r setup, include=FALSE}

# Options

        knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

# Libraries

        library(tidyverse)
        library(plotly)
        library(visNetwork)

```


## Curse You Fortnite

My son plays the video game Fortnite [(click here)](https://www.epicgames.com/fortnite/en-US/buy-now/battle-royale?utm_source=GoogleSearch&utm_medium=Search&utm_campaign=an*YH_pr*FNBR_ct*Search_pl*Brand_co*US_cr*exact&utm_id=847971038&utm_content=&gclid=CjwKCAjwxZnYBRAVEiwANMTRX51CkyOTL7ZvmqlImBXNAym4muD_R9uOad134e1WiqFxRCte-Q2mfBoCy4MQAvD_BwE).  A *lot* of Fortnite!   Given the opportunity, he easily puts in a full day's work (8 + hrs) into Fortnite.  When he's not playing Fortnite, he may very well be watching other people play Fortnite, perfecting his Fortnite dances, or watching replays of his greatest "eliminations".  

## Sometimes It's Better to Be Lucky Than Good

I have to admit, if I were his age I would play Fortnite too.  But I'm his Dad, so instead I worry that he is playing too much Fortnite.  I'm also a data scientist (or at least my employer and peers think I am), so I thought I might temper his Fortnite time by convincing him that a lot of the game is luck.  Even more, I thought it would be a fun coding project to work on together.  With that in mind, we set off to estimate (via simulation) how much battle success is attributable to skill vs luck. Here's the short version: About **60% of Fortnite is skill, 40% is luck**.

Here's the long version...

## Break a Big Problem into a Bunch of Small Problems

We broke the problem of determining how much of Fortnite is skill vs luck into the following basic steps

*Set-up*

1. Create a few parameters for the simulation

        + Size of the Fortnite universe (total number of players)
        + Min and max number of players for any given game (typically between 80-100)
        + Proportion of skill (between 0 and 1); Proportion of luck is then 1 - proportion of skill
        + Target rank (here the #1 player in the world)
        + Number of games to simulate
        
2. Create a universe of players

        + Each player is randomly assigned a rating (skill level) between 0 and 1
        + Players are then ranked from best (#1) to worst
        
        
*Play a Game*
        
3. Randomly select players for a game
4. Randomly select 2 players for a battle
5. Randomly assign a luck parameter to each of the 2 players selected
6. Calculate each player's battle score ( p x skill + (1-p) x luck, where p = proportion due to skill)
7. Eliminate player with lower battle score
8. Repeat steps 3-8 until only 1 player remains!

*Play Lots of Games*

9. Select a proportion of skill to simulate
10. Repeat steps 3-8 1000 x (or more)
11. Repeat steps 9-10  (with different proportions of skill)

*Estimate Proportion of Skill*

12. Plot % of wins vs proportion of skill (for the #1 player in the world)
13. Compare % of wins for the actual #1 player in the world to the curve (in step #12)


```{r constants, echo = FALSE}
           
        # Define Total Gamer Population
        # Used 100000, but to Shorten Run Time for Demo/Development, Use 100
        n_players <- 100 
        
        # Number of Players Per Game
        min_players_game <- 80
        max_players_game <- 100
        
        # Proportion of Skill (vs Luck)
        # Change this to study the % Wins vs Proportion of Skill
        proportion_skill <- 0.6

        # Target Rank
        target_rank <- 1

        # Number of Games to Play
        # Used 1000, but to Shortenr Run Time for Demo/Development, use 10
        n_games <- 10
     
```

```{r create_universe, echo = FALSE}
        
        df_universe <- data_frame(
                
                # Player Number / ID
                player_id = 1:n_players,
                # Random Rating
                player_rating = rnorm(n = n_players)
                
        ) 
                
        # Scale Player Ratings to be Between 0 and 1

        df_universe <- df_universe %>% 
                
                # Add Column of Min
                mutate(min_player_rating = abs(min(player_rating))) %>% 
                
                # Adjust Min to Zero
                mutate(player_rating = player_rating + min_player_rating) %>% 
                
                # Add max Player Rating
                mutate(max_player_rating = max(player_rating)) %>% 
                
                # Scale Max Back to 1
                mutate(player_rating = player_rating / max_player_rating) %>% 
        
                # Remove Extra Columns
                select(-min_player_rating, -max_player_rating) %>% 
                
                # Arrange in Order of Rating
                arrange(desc(player_rating)) %>% 
                
                # Add Player Rankings
                mutate(player_rank = rank(desc(player_rating)))
        
        # Check Universe
        # df_universe
        # summary(df_universe)
        
```

```{r select_players, echo = FALSE}
        
        f_select <- function(
                
                df_universe,
                min_players_game,
                max_players_game,
                target_rank
                
                ){
                
                df_game_players <- df_universe %>% 
                        sample_n(runif(n = 1, min = min_players_game, max = max_players_game))
                
                # Add Targeted Ranked Player
                df_game_players <- bind_rows(
                        df_universe %>% filter(player_rank == target_rank),
                        df_game_players
                ) %>% 
                        # Make Sure Targeted Player Only in Once
                        unique()
                
                # Add Placeholder for Place (Results of Game)
                df_game_players <- df_game_players %>%
                        mutate(Place = NA) %>% 
                        mutate(Eliminated_By = NA)
                
                return(df_game_players)
                
        }
        
```        

```{r battle, echo = FALSE}
        
        f_battle <- function(df_game_players = df_game_players){
                
                # Battle and ID Loser
                df_battle <- df_game_players %>% 
                        
                        # Only Use Players Still in the Game
                        filter(is.na(Place)) %>% 
                        
                        # Randomly Pick Two Players
                        sample_n(size = 2) %>% 
                        
                        # Generate Luck
                        mutate(player_battle_luck = runif(n = 2, min = 0, max = 1)) %>% 
                        
                        # Calculate Battle Power Ratings
                        mutate(battle_power = proportion_skill * player_rating + (1-proportion_skill) * player_battle_luck) 
                
                da_winna <- df_battle %>% 
                        
                        # ID / Pull Winner
                        filter(battle_power == max(battle_power)) %>% 
                        
                        # Only Keep Non-Battle Related Data
                        pull(player_id)
                
                
                df_battle_loser <- df_battle %>% 
                
                        # ID / Pull Loser
                        filter(battle_power == min(battle_power)) %>% 
                        
                        # Only Keep Non-Battle Related Data
                        select(-player_battle_luck, -battle_power) 
                        
                
                # Remove Loser From Game
                df_game_players <- df_game_players %>% 
                        anti_join(df_battle_loser,
                                  # To Avoid Printing Joining, by =
                                  by = c("player_id", "player_rating", "player_rank", "Place", "Eliminated_By"))
                
                        
                # Add Place to Losing Player
                df_battle_loser <- df_battle_loser %>% 
                        mutate(Place = ifelse(min(df_game_players$Place, na.rm = TRUE) == Inf, 
                                                nrow(df_game_players) + 1, 
                                                min(df_game_players$Place, na.rm = TRUE) - 1
                )) %>% 
                        mutate(Eliminated_By = da_winna)
                        
                
                # Add Battle Loser Back to Game Players
                df_game_players <- bind_rows(df_battle_loser, df_game_players)
                
                # Return Results
                df_game_players
                
        }

```

```{r play_game, echo = FALSE}
        
        f_game <- function(df_game_players){
                
                for(i in 1:(nrow(df_game_players)-1)){
                        df_game_players <- f_battle(df_game_players = df_game_players)        
                }
                
                # Last Player Standing Wins (Place = 1)
                df_game_players <- df_game_players %>% 
                        mutate(Place = ifelse(is.na(Place), 1, Place)) %>% 
                        arrange(Place)
                
                return(df_game_players)
                
        }

```

```{r simulate_single_game, echo = FALSE}
        
        # Select Players
        df_game_players <- f_select(df_universe = df_universe, 
                                    min_players_game = min_players_game, 
                                    max_players_game = max_players_game, 
                                    target_rank = target_rank)

        # Play a Single Game
        game_out <- f_game(df_game_players = df_game_players)
        
        # Calculate Number of Kills
        game_out <- left_join(
                
                game_out,
                
                game_out %>% 
                        group_by(Eliminated_By) %>% 
                        summarise(N_Kills = n()) %>% 
                        rename(player_id = Eliminated_By)
                
        ) %>% 
                mutate(N_Kills = ifelse(is.na(N_Kills), 0, N_Kills))
      
        
```

```{r single_game_out1, echo = FALSE}

        # Display
        # game_out

```

```{r single_game_out2, echo = FALSE}
        
        # Game Network
        df_nodes <- game_out %>% 
                select(id = player_id, label = Place, value = N_Kills) %>% 
                mutate(color = ifelse(label == 1, "orange", "steelblue"))
        
        df_edges <- game_out %>% 
                select(from = Eliminated_By, to = player_id) %>% 
                na.omit()
        
        vnet <- visNetwork(nodes = df_nodes, edges = df_edges) %>% 
                visNodes(scaling = list(min = 10, max = 50))
   
```

```{r single_game_out3, echo = FALSE}

       # Histogram of Kills
       p_hist <- ggplot() + 
               geom_bar(data = game_out, aes(x=N_Kills), fill = "darkblue") +
               scale_x_continuous(breaks = seq(0, max(game_out$N_Kills), 1)) +
               theme_minimal() +
               xlab("N Kills") + ylab("N Players")
       
       # ggplotly(p)
        
        
```

```{r simulate_many_games, echo = FALSE}
        
        # purrr Many Games
        l_games <- 1:n_games %>% map(~f_select( 
                     df_universe, 
                     min_players_game, 
                     max_players_game, 
                     target_rank)
        ) %>% map(~f_game(.x)) 
        
        
        # Combine to Single Data Frame
        df_out <- l_games %>% reduce(bind_rows)        
        
```

```{r percent_wins, echo = FALSE}

        # Calculate Percent Wins
        df_percent_wins <- df_out %>% 
                filter(player_rating == target_rank) %>% 
                mutate(Win = ifelse(Place == 1, "Win", "Go Home")) %>% 
                group_by(Win) %>% 
                summarise(N = n()) %>% 
                mutate(Percent_Win = round(100*N / sum(N), 2))
        
```

```{r save, echo = FALSE}             
        
        prop_skill <- c(1.0, 0.9,  0.8, 0.7, 0.65, 0.6, 0.55, 0.5, 0.4, 0.3, 0.2, 0.1, 0)
        percent_wins <- c(100, 100, 98.6, 79.7, 63.4, 49.5, 41, 21.1, 9.3, 6.4, 2.4, 2.0, 1.4)
        
        
```
  
```{r plot, echo = FALSE}   


        # MOdel: percent_wins = c / (1 + exp(-a * (prop_skill - b)))
        
        # Note: Some Pre-work Conducted to Estimate Starting Values
        out <- nls(percent_wins ~ c / (1 + exp(-a * (prop_skill - b))),
                   start = list(a=11.7, b=0.6, c=103))

        # Check Fit
        # cor(percent_wins, predict(out))
        
        # Plot
        df_plot <- data_frame(percent_wins, prop_skill, predict = predict(out))
        
        p <- ggplot()
        p <- p + geom_point(data = df_plot, aes(x = prop_skill, y = percent_wins))
        # p <- p + geom_smooth(data = df_plot, aes(x = prop_skill, y = percent_wins), se = FALSE)
        p <- p + geom_line(data = df_plot, aes(x = prop_skill, y = predict), lty = 2, col = "blue")
        p <- p + geom_hline(yintercept = 50, col = "orange", lty = 2)
        p <- p + geom_vline(xintercept = 0.6, col = "orange", lty = 2)
        p <- p + theme_minimal(base_size = 12)
        p <- p + scale_x_continuous(breaks = seq(0,1,0.1))
        p <- p + scale_y_continuous(breaks = seq(0,100,10))
        p <- p + xlab("Proportion of Skill") + ylab("% Wins")
        p <- p + labs(title = "Win % vs Proportion of Skill",
                      subtitle = "For #1 Player in Simulated Universe")
        
        # p
        
```


## Results


*Single Game* 

First, let's look at the results from a single game. The table below is sorted so you can see where each player placed in the game, how many kills they had, and who eliminated them.  In addition, you can see each player's skill level (player_rating). 

```{r results1, echo = FALSE}

        # Display
        game_out

```

Next is a network visualization of the game, because *everyting is connected*.  

* Each node represents a player in the game
* The edges connect each player to the player(s) they eliminated and/or the player who eliminated them
* The orange node represents the game winner
* The size of each node represents the number of kills that player had in the game
* The numerical values associated with each node identify where that player placed in the simulated game
* Use your mouse to pan and zoom in/out on the plot

If you spend enough time studying the network plot you will find a couple of things to be true.  Players do not always need to have a lot of kills to be one of the final players left!  [Run away, run away!](https://www.youtube.com/watch?v=7FPELc1wEvk) may be an excellent strategy.  In fact, the winner of the game depends on most of the other players eliminating each other.

```{r results2, echo = FALSE}
        
        # Game Network
        df_nodes <- game_out %>% 
                select(id = player_id, label = Place, value = N_Kills) %>% 
                mutate(color = ifelse(label == 1, "orange", "steelblue"))
        
        df_edges <- game_out %>% 
                select(from = Eliminated_By, to = player_id) %>% 
                na.omit()
        
        visNetwork(nodes = df_nodes, edges = df_edges) %>% 
                visNodes(scaling = list(min = 10, max = 50))
   
```

Finally, a quick peek at a histogram of the number of kills for each player suggests a large portion of players are eliminated before they get any kills, and that players with more than 3-4 kills are at the top of the game.

```{r results3, echo = FALSE}

       # Histogram of Kills
       p_hist <- ggplot() + 
               geom_bar(data = game_out, aes(x=N_Kills), fill = "darkblue") +
               scale_x_continuous(breaks = seq(0, max(game_out$N_Kills), 1)) +
               theme_minimal() +
               xlab("N Kills") + ylab("N Players")
       
       ggplotly(p_hist)
        
        
```
   
*Many Games* 
   
Finally, after running a 1000 games each at various proportions of skill, it is possible to model the relationship between win percent and proportion of skill.  Recall that this curve is for the #1 player in our simulated universe.  In addition, we know the top players in the world win about 50% of the time [click here.](https://fortnitetracker.com/)  Drawing a horizontal line at 50% wins, it is clear that this happens when the proportion of skill is ~60% (0.60).
   
   
```{r results4, echo = FALSE}   


        # MOdel: percent_wins = c / (1 + exp(-a * (prop_skill - b)))
        
        # Note: Some Pre-work Conducted to Estimate Starting Values
        out <- nls(percent_wins ~ c / (1 + exp(-a * (prop_skill - b))),
                   start = list(a=11.7, b=0.6, c=103))

        # Check Fit
        # cor(percent_wins, predict(out))
        
        # Plot
        df_plot <- data_frame(percent_wins, prop_skill, predict = predict(out))
        
        p <- ggplot()
        p <- p + geom_point(data = df_plot, aes(x = prop_skill, y = percent_wins))
        # p <- p + geom_smooth(data = df_plot, aes(x = prop_skill, y = percent_wins), se = FALSE)
        p <- p + geom_line(data = df_plot, aes(x = prop_skill, y = predict), lty = 2, col = "blue")
        p <- p + geom_hline(yintercept = 50, col = "orange", lty = 2)
        p <- p + geom_vline(xintercept = 0.6, col = "orange", lty = 2)
        p <- p + theme_minimal(base_size = 12)
        p <- p + scale_x_continuous(breaks = seq(0,1,0.1))
        p <- p + scale_y_continuous(breaks = seq(0,100,10))
        p <- p + xlab("Proportion of Skill") + ylab("% Wins")
        p <- p + labs(title = "Win % vs Proportion of Skill",
                      subtitle = "For #1 Player in Simulated Universe")
        
        p
        
        
```
<br>

There are obviously many assumptions and simplifications in this simulation, but the findings are consistent with a bit of reasoned logic. If Fortnite was based on 100% skill, less skilled players would always lose and quickly become disinterested. In contrast, if Fortnite was based on 100% luck, players would figure out that nothing they do improves their game, and would similarly lose interest.   


## R Code


```{r code, results = 'hide'}

# Constants ====

# First, set the constants and parameters for the simulation. Note the target rank is set to study the #1 player in our universe.  We can then compare our results to the  best players in the real world, who win about 50% of their games (https://fortnitetracker.com/leaderboards).  OK, that sounds strange - labeling a virtual gaming world as the "real world"...


# Define Total Gamer Population
# Used 100000, but to Shorten Run Time for Demo/Development, Use 100
n_players <- 100 

# Number of Players Per Game
min_players_game <- 80
max_players_game <- 100

# Proportion of Skill (vs Luck)
# Change this to study the % Wins vs Proportion of Skill
proportion_skill <- 0.6

# Target Rank
target_rank <- 1

# Number of Games to Play
# Used 1000, but to Shortenr Run Time for Demo/Development, use 10
n_games <- 10

# Create Universe of Players ====

# Next create a univere of players.  The main task here is to randomly apply and standardize player rating (skill) for each player to be between 0 and 1.  Run a quick check at the end of this code chunk to validate.

df_universe <- data_frame(
        
        # Player Number / ID
        player_id = 1:n_players,
        # Random Rating
        player_rating = rnorm(n = n_players)
        
) 

# Scale Player Ratings to be Between 0 and 1

df_universe <- df_universe %>% 
        
        # Add Column of Min
        mutate(min_player_rating = abs(min(player_rating))) %>% 
        
        # Adjust Min to Zero
        mutate(player_rating = player_rating + min_player_rating) %>% 
        
        # Add max Player Rating
        mutate(max_player_rating = max(player_rating)) %>% 
        
        # Scale Max Back to 1
        mutate(player_rating = player_rating / max_player_rating) %>% 
        
        # Remove Extra Columns
        select(-min_player_rating, -max_player_rating) %>% 
        
        # Arrange in Order of Rating
        arrange(desc(player_rating)) %>% 
        
        # Add Player Rankings
        mutate(player_rank = rank(desc(player_rating)))

# Check Universe
# df_universe
# summary(df_universe)


# Funtion to Select Players for Game ====

# We have the universe of Fortnite players, but before we can run the simulation, we need to create a few functions. The first function selects players from the universe for a single game.  Note the number of players selected is between the min and max player parameters.  In addition, the target player (#1 ranked player) is selected to play in every game (because this is who we want to study)!

f_select <- function(
        
        df_universe,
        min_players_game,
        max_players_game,
        target_rank
        
){
        
        df_game_players <- df_universe %>% 
                sample_n(runif(n = 1, min = min_players_game, max = max_players_game))
        
        # Add Targeted Ranked Player
        df_game_players <- bind_rows(
                df_universe %>% filter(player_rank == target_rank),
                df_game_players
        ) %>% 
                # Make Sure Targeted Player Only in Once
                unique()
        
        # Add Placeholder for Place (Results of Game)
        df_game_players <- df_game_players %>%
                mutate(Place = NA) %>% 
                mutate(Eliminated_By = NA)
        
        return(df_game_players)
        
}

# Function to Fight a Battle ==== 

# Next, we create a function to simulate a battle between two players.  This is the guts of the simulation!  When two players engage in a battle, one is victorious and continues on the path to Fortnite glory.  The other bangs the floor in disgust and makes a comment about how their opponent has no friends and/or how the Fortnite designers need to fix their game.

# To win a battle in the simulation, you simply need a larger battle score.  The battle score is composed of the specified proportion of his or her skill plus some random luck.  Recall that the skill ratings range between 0 and 1.  Here, random luck, which is generated for each player for each battle, also ranges between 0 and 1.  The battle rating is then simply a linear combination of skill + luck:  proportion_skill x skill + (1-proportion_skill) x luck.  The minimum battle score is then 0, while the maximum battle score is 1. 

# After a battle, the eliminated player is removed from the game and his or her game ranking is recorded.  The winner survives and gets added back into the game.

f_battle <- function(df_game_players = df_game_players){
        
        # Battle and ID Loser
        df_battle <- df_game_players %>% 
                
                # Only Use Players Still in the Game
                filter(is.na(Place)) %>% 
                
                # Randomly Pick Two Players
                sample_n(size = 2) %>% 
                
                # Generate Luck
                mutate(player_battle_luck = runif(n = 2, min = 0, max = 1)) %>% 
                
                # Calculate Battle Power Ratings
                mutate(battle_power = proportion_skill * player_rating + (1-proportion_skill) * player_battle_luck) 
        
        da_winna <- df_battle %>% 
                
                # ID / Pull Winner
                filter(battle_power == max(battle_power)) %>% 
                
                # Only Keep Non-Battle Related Data
                pull(player_id)
        
        
        df_battle_loser <- df_battle %>% 
                
                # ID / Pull Loser
                filter(battle_power == min(battle_power)) %>% 
                
                # Only Keep Non-Battle Related Data
                select(-player_battle_luck, -battle_power) 
        
        
        # Remove Loser From Game
        df_game_players <- df_game_players %>% 
                anti_join(df_battle_loser,
                          # To Avoid Printing Joining, by =
                          by = c("player_id", "player_rating", "player_rank", "Place", "Eliminated_By"))
        
        
        # Add Place to Losing Player
        df_battle_loser <- df_battle_loser %>% 
                mutate(Place = ifelse(min(df_game_players$Place, na.rm = TRUE) == Inf, 
                                      nrow(df_game_players) + 1, 
                                      min(df_game_players$Place, na.rm = TRUE) - 1
                )) %>% 
                mutate(Eliminated_By = da_winna)
        
        
        # Add Battle Loser Back to Game Players
        df_game_players <- bind_rows(df_battle_loser, df_game_players)
        
        # Return Results
        df_game_players
        
}


# Function to Play Game ====

# Given the basic unit of a battle, it is then possible to simulate a game as a series of battles that proceeds until there is only one player left.  The following function does this...

f_game <- function(df_game_players){
        
        for(i in 1:(nrow(df_game_players)-1)){
                df_game_players <- f_battle(df_game_players = df_game_players)        
        }
        
        # Last Player Standing Wins (Place = 1)
        df_game_players <- df_game_players %>% 
                mutate(Place = ifelse(is.na(Place), 1, Place)) %>% 
                arrange(Place)
        
        return(df_game_players)
        
}

# Play a Single Game ====

# Now we can simulate a game!  

# Select Players
df_game_players <- f_select(df_universe = df_universe, 
                            min_players_game = min_players_game, 
                            max_players_game = max_players_game, 
                            target_rank = target_rank)

# Play Game
game_out <- f_game(df_game_players = df_game_players)

# Calculate Number of Kills
game_out <- left_join(
        
        game_out,
        
        game_out %>% 
                group_by(Eliminated_By) %>% 
                summarise(N_Kills = n()) %>% 
                rename(player_id = Eliminated_By)
        
) %>% 
        mutate(N_Kills = ifelse(is.na(N_Kills), 0, N_Kills))


# Visualize Single Game Results ====

# We've played a game of Fortnite - let's look at the results.  


# Display
game_out


# Game Network
df_nodes <- game_out %>% 
        select(id = player_id, label = Place, value = N_Kills) %>% 
        mutate(color = ifelse(label == 1, "orange", "steelblue"))

df_edges <- game_out %>% 
        select(from = Eliminated_By, to = player_id) %>% 
        na.omit()

visNetwork(nodes = df_nodes, edges = df_edges) %>% 
        visNodes(scaling = list(min = 10, max = 50))

# Histogram of Kills
p_hist <- ggplot() + 
        geom_bar(data = game_out, aes(x=N_Kills), fill = "darkblue") +
        scale_x_continuous(breaks = seq(0, max(game_out$N_Kills), 1)) +
        theme_minimal() +
        xlab("N Kills") + ylab("N Players")

ggplotly(p_hist)


# Simulate Many Games ====

# It was fun to look at the results of one game, but now we want to simulate lots and lots of games. To do so, we use what has become one of my favorite R packages (purrr).

# purrr Many Games
l_games <- 1:n_games %>% map(~f_select( 
        df_universe, 
        min_players_game, 
        max_players_game, 
        target_rank)
) %>% map(~f_game(.x)) 


# Combine to Single Data Frame
df_out <- l_games %>% reduce(bind_rows)        

# After simulating many games, we can determine the % of wins - in this case for the #1 player in our universe. 

# Calculate Percent Wins
df_percent_wins <- df_out %>% 
        filter(player_rating == target_rank) %>% 
        mutate(Win = ifelse(Place == 1, "Win", "Go Home")) %>% 
        group_by(Win) %>% 
        summarise(N = n()) %>% 
        mutate(Percent_Win = round(100*N / sum(N), 2))

# Manually Save Results from Each Simulation (at Various Proportion of Skill) ====

# Perhaps a bit lame, but easy enough and functionally sufficient, I manually created the following vectors after running the simulation at each specified proportion of skill.   

prop_skill <- c(1.0, 0.9,  0.8, 0.7, 0.65, 0.6, 0.55, 0.5, 0.4, 0.3, 0.2, 0.1, 0)
percent_wins <- c(100, 100, 98.6, 79.7, 63.4, 49.5, 41, 21.1, 9.3, 6.4, 2.4, 2.0, 1.4)

# Create Model (% Wins vs Prop Skill) ====

# Given the results of our simulations, we can then create a curve summarizing the expected % of wins for the #1 player in the world as a function of our parameter, proportion of skill.  

# MOdel: percent_wins = c / (1 + exp(-a * (prop_skill - b)))

# Note: Some Pre-work Conducted to Estimate Starting Values
out <- nls(percent_wins ~ c / (1 + exp(-a * (prop_skill - b))),
           start = list(a=11.7, b=0.6, c=103))

# Check Fit
cor(percent_wins, predict(out))

# Plot Simulation Results to ID % Skill ====

# Recall that we know the top players in the world win about 50% of the time.  Drawing a horizontal line at 50% wins, it is clear that this happens when the proportion of skill is ~60% (0.60).

# Plot
df_plot <- data_frame(percent_wins, prop_skill, predict = predict(out))

p <- ggplot()
p <- p + geom_point(data = df_plot, aes(x = prop_skill, y = percent_wins))
# p <- p + geom_smooth(data = df_plot, aes(x = prop_skill, y = percent_wins), se = FALSE)
p <- p + geom_line(data = df_plot, aes(x = prop_skill, y = predict), lty = 2, col = "blue")
p <- p + geom_hline(yintercept = 50, col = "orange", lty = 2)
p <- p + geom_vline(xintercept = 0.6, col = "orange", lty = 2)
p <- p + theme_minimal(base_size = 12)
p <- p + scale_x_continuous(breaks = seq(0,1,0.1))
p <- p + scale_y_continuous(breaks = seq(0,100,10))
p <- p + xlab("Proportion of Skill") + ylab("% Wins")
p <- p + labs(title = "Win % vs Proportion of Skill",
              subtitle = "For #1 Player in Simulated Universe")



```


*Have a nice day!*